<!DOCTYPE html>
<html lang="zh-CN">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="可能是目前最好用的网络配置备份工具-oxidized"/><meta name="keywords" content="network, centos, oxidized, NBMA" /><link rel="alternate" href="/atom.xml" title="NBMA" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.1" />
<link rel="canonical" href="http://nbma.info/maybe-the-best-conf-backup-tool-oxidized/"/>

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.1" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-126503503-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-126503503-1');
</script><script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":false};
</script>

    <title>可能是目前最好用的网络配置备份工具-oxidized - NBMA</title>
  <meta name="generator" content="Hexo 5.4.0"></head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">NBMA</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">首页
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">归档
          </li>
      </a><a href="/tags">
        <li class="mobile-menu-item">标签
          </li>
      </a><a href="/about">
        <li class="mobile-menu-item">关于
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">NBMA</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            首页
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            归档
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            标签
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about">
            关于
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">可能是目前最好用的网络配置备份工具-oxidized
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-09-28
        </span><span class="post-category">
            <a href="/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/">技术笔记</a>
            </span>
        </div>
    </header>

    <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-text">安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-CentOS%E6%89%8B%E5%8A%A8%E5%AE%89%E8%A3%85"><span class="toc-text">1. CentOS手动安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-docker%E5%90%AF%E5%8A%A8"><span class="toc-text">2. docker启动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E9%85%8D%E7%BD%AE"><span class="toc-text">初始配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-source"><span class="toc-text">1. source</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-output"><span class="toc-text">2. output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-hook"><span class="toc-text">3. hook</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C"><span class="toc-text">运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96feature"><span class="toc-text">其他feature</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nginx%E7%9A%84web%E9%AA%8C%E8%AF%81"><span class="toc-text">nginx的web验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E5%A4%87group"><span class="toc-text">设备group</span></a></li></ol></li></ol>
    </div>
  </div><div class="post-content"><p>说起配置管理，一直我面临的头疼问题——企业网的设备品牌太多太杂了。<br>基本上很少有机会去使用厂商私有的配置管理工具。SolarWinds的KiWi CaTools是一个非常不错的商业解决方案，但是，应该没有多少公司会在信息化上投入太多成本吧。</p>
<span id="more"></span>
<p>之前我是从网上找的和谐版CaTools，不过由于版本太旧，只能支持部分品牌的设备，将就了大半年。正要准备用python的netmiko自己写一个的时候，发现了这个工具——oxidized。简单测试了下，已经能覆盖我司的全部设备。</p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>oxidized是一个轻量、可扩展的网络设备配置工具，目前能支持90多种操作系统。</p>
<ul>
<li>支持多线程</li>
<li>支持多种数据源（csv,db,http）</li>
<li>支持多种输出类型（file,git,http）</li>
<li>支持RESTful API</li>
</ul>
<p>Github项目地址：<a target="_blank" rel="noopener" href="https://github.com/ytti/oxidized">oxidized</a></p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>oxidized可以直接通过ruby的gem进行安装，也可以从docker启动:</p>
<h3 id="1-CentOS手动安装"><a href="#1-CentOS手动安装" class="headerlink" title="1. CentOS手动安装"></a>1. CentOS手动安装</h3><p>基于ruby，所以需要先把centos7上的ruby2.0升级到2.3版本，这里是有RVM来管理ruby版本。<br>首先是更新依赖包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y curl gcc-c++ patch readline readline-devel zlib zlib-devel</span><br><span class="line">yum install -y libyaml-devel libffi-devel openssl-devel make cmake</span><br><span class="line">yum install -y bzip2 autoconf automake libtool bison iconv-devel libssh2-devel libicu-devel</span><br></pre></td></tr></table></figure>

<p>安装RVM前需要先导入gpg的公钥:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gpg2 --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3</span><br><span class="line"><span class="comment">#安装：</span></span><br><span class="line">curl -L get.rvm.io | bash -s stable</span><br></pre></td></tr></table></figure>

<p>最新的rvm安装完成之后，还需手动把当前用户添加到rvm组才行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#把root用户加入到rvm group</span></span><br><span class="line">usermod -a -G rvm root</span><br></pre></td></tr></table></figure>

<p>log out注销当前用户，然后再log in重新读取组信息，可以使用<code>groups</code>命令查看当前用户的数组，加入rvm组后可以执行rvm命令<br>设置RVM环境并编译，然后安装Ruby 2.3.0并设置为默认值</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile.d/rvm.sh</span><br><span class="line">rvm install 2.3.0</span><br><span class="line">rvm use --default 2.3.0</span><br></pre></td></tr></table></figure>

<p>然后就可以通过Rubygems安装<code>oxidized</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gem install oxidized</span><br><span class="line">gem install oxidized-script oxidized-web</span><br><span class="line"><span class="comment"># 如果不想安装oxidized-web，需要在启动前从config里删除rest部分的配置</span></span><br></pre></td></tr></table></figure>

<p>安装完成后就可以进行初始配置了。</p>
<h3 id="2-docker启动"><a href="#2-docker启动" class="headerlink" title="2. docker启动"></a>2. docker启动</h3><p>首先需要创建一个配置文件的目录在宿主机上：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /etc/oxidized</span><br></pre></td></tr></table></figure>

<p>然后第一次运行容器，来生成初始配置文件：</p>
<blockquote>
<p>这一步仅用作生成config文件，如果已经有了，跳过这一步</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --rm -v /etc/oxidized:/root/.config/oxidized -p 8888:8888/tcp -t oxidized/oxidized:latest oxidized</span><br></pre></td></tr></table></figure>

<p>这个时候<code>/etc/oxidized</code>下应该已经有了一个config文件，把它编辑成你想要的样子;</p>
<p>同时，创建数据源<code>/etc/oxidized/router.db</code>（下文具体解析config文件的内容和数据源格式）</p>
<p>正式启动容器：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -v /etc/oxidized:/root/.config/oxidized -p 8888:8888/tcp -t oxidized/oxidized:latest</span><br><span class="line"><span class="comment"># 成功启动后会看到如下信息：</span></span><br><span class="line">oxidized[1]: Oxidized starting, running as pid 1</span><br><span class="line">oxidized[1]: Loaded 1 nodes</span><br><span class="line">Puma 2.13.4 starting...</span><br><span class="line">* Min threads: 0, max threads: 16</span><br><span class="line">* Environment: development</span><br><span class="line">* Listening on tcp://0.0.0.0:8888</span><br></pre></td></tr></table></figure>


<h2 id="初始配置"><a href="#初始配置" class="headerlink" title="初始配置"></a>初始配置</h2><p>Oxidized的配置文件是用的yaml格式，文件默认读取目录是<code>/etc/oxidized/config</code>和<code>~/.config/oxidized/config</code>。<br>初次运行的时候会自动生成默认的<code>~/.config/oxidized/config</code></p>
<p>config文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">username:</span> <span class="string">username</span></span><br><span class="line"><span class="attr">password:</span> <span class="string">password</span></span><br><span class="line"><span class="attr">model:</span> <span class="string">junos</span></span><br><span class="line"><span class="attr">resolve_dns:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">log:</span> <span class="string">/var/log/oxidized.log</span></span><br><span class="line"><span class="attr">interval:</span> <span class="number">3600</span></span><br><span class="line"><span class="attr">use_syslog:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">debug:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">threads:</span> <span class="number">30</span></span><br><span class="line"><span class="attr">timeout:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">retries:</span> <span class="number">3</span></span><br><span class="line"><span class="attr">prompt:</span> <span class="type">!ruby/regexp</span> <span class="string">/^([\w.@-]+[#&gt;]\s?)$/</span></span><br><span class="line"><span class="attr">rest:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8888</span></span><br><span class="line"><span class="attr">next_adds_job:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">vars:</span> &#123;&#125;</span><br><span class="line"><span class="attr">groups:</span> &#123;&#125;</span><br><span class="line"><span class="attr">models:</span> &#123;&#125;</span><br><span class="line"><span class="attr">pid:</span> <span class="string">&quot;/root/.config/oxidized/pid&quot;</span></span><br><span class="line"><span class="attr">crash:</span></span><br><span class="line">  <span class="attr">directory:</span> <span class="string">&quot;/root/.config/oxidized/crashes&quot;</span></span><br><span class="line">  <span class="attr">hostnames:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">stats:</span></span><br><span class="line">  <span class="attr">history_size:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">input:</span></span><br><span class="line">  <span class="attr">default:</span> <span class="string">ssh,</span> <span class="string">telnet</span></span><br><span class="line">  <span class="attr">debug:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">ssh:</span></span><br><span class="line">    <span class="attr">secure:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">ftp:</span></span><br><span class="line">    <span class="attr">passive:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">utf8_encoded:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">output:</span></span><br><span class="line">  <span class="attr">default:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">git:</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">Mansur</span></span><br><span class="line">    <span class="attr">email:</span> <span class="string">i@nbma.info</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">&quot;/root/.config/oxidized/backup_conf/devices.git&quot;</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">    <span class="attr">directory:</span> <span class="string">&quot;/root/.config/oxidized/configs&quot;</span></span><br><span class="line"><span class="attr">hooks:</span></span><br><span class="line">  <span class="attr">push_to_remote:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">githubrepo</span></span><br><span class="line">    <span class="attr">events:</span> [<span class="string">post_store</span>]</span><br><span class="line">    <span class="attr">user:</span> <span class="string">Mansur</span></span><br><span class="line">    <span class="attr">email:</span> <span class="string">i@nbma.info</span></span><br><span class="line">    <span class="attr">remote_repo:</span> <span class="string">git@nbma.info:mansur/test-oxidized.git</span></span><br><span class="line">    <span class="attr">publickey:</span> <span class="string">/root/.ssh/id_rsa.pub</span></span><br><span class="line">    <span class="attr">privatekey:</span> <span class="string">/root/.ssh/id_rsa</span></span><br><span class="line"><span class="attr">source:</span></span><br><span class="line">  <span class="attr">default:</span> <span class="string">csv</span></span><br><span class="line">  <span class="attr">csv:</span></span><br><span class="line">    <span class="attr">file:</span> <span class="string">&quot;/root/.config/oxidized/router.db&quot;</span></span><br><span class="line">    <span class="attr">delimiter:</span> <span class="type">!ruby/regexp</span> <span class="string">/:/</span></span><br><span class="line">    <span class="attr">map:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="number">0</span></span><br><span class="line">      <span class="attr">ip:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">model:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">username:</span> <span class="number">3</span></span><br><span class="line">      <span class="attr">password:</span> <span class="number">4</span></span><br><span class="line">    <span class="attr">gpg:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">model_map:</span></span><br><span class="line">  <span class="attr">cisco:</span> <span class="string">ios</span></span><br><span class="line">  <span class="attr">juniper:</span> <span class="string">junos</span></span><br></pre></td></tr></table></figure>

<p>需要关注的内容不多：<br><code>username</code>, <code>password</code>, <code>model</code>这些无需修改，source文件里的相应字段会更优先;<br><code>interval</code>即是备份的周期；<br><code>rest</code>部分是oxidized-web生成的网页，可以直观的查看各个设备的备份状态，保持127.0.0.0，后面可以另外部署一个nginx用于代理和认证。<br>下面是其他几个比较重要的配置：</p>
<h3 id="1-source"><a href="#1-source" class="headerlink" title="1. source"></a>1. source</h3><p>定义了数据源，<code>map</code>是解析的字段映射：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">more /root/.config/oxidized/router.db</span><br><span class="line">S5720-05:192.168.1.2:vrp:admin:Admin@123</span><br><span class="line">C2960-01:192.168.1.3:ios:cisco:Cisco@123</span><br></pre></td></tr></table></figure>

<h3 id="2-output"><a href="#2-output" class="headerlink" title="2. output"></a>2. output</h3><ul>
<li>file 以文件方式输出</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">output:</span></span><br><span class="line">  <span class="attr">default:</span> <span class="string">file</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">    <span class="attr">directory:</span> <span class="string">&quot;/root/.config/oxidized/configs&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>git 以git方式输出</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">output:</span></span><br><span class="line">  <span class="attr">default:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">git:</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">Mansur</span></span><br><span class="line">    <span class="attr">email:</span> <span class="string">i@nbma.info</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">&quot;/root/.config/oxidized/backup_conf/devices.git&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-hook"><a href="#3-hook" class="headerlink" title="3. hook"></a>3. hook</h3><p>hook需要先指定类型，然后通过监听事件event来执行相应的动作</p>
<ul>
<li>push_to_remote</li>
</ul>
<p>将配置保存到公司的gitlab是个不错的选择，可以方便直观的进行历史版本控制，以及进行配置对比。<br>push_to_remote能够运行的前提是output是以git方式进行输出。<br>先到gitlab上新建一个repo，然后上传key，修改oxidized的配置文件：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">hooks:</span></span><br><span class="line">  <span class="attr">push_to_remote:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">githubrepo</span></span><br><span class="line">    <span class="attr">events:</span> [<span class="string">post_store</span>]</span><br><span class="line">    <span class="attr">user:</span> <span class="string">Mansur</span></span><br><span class="line">    <span class="attr">email:</span> <span class="string">i@nbma.info</span></span><br><span class="line">    <span class="attr">remote_repo:</span> <span class="string">git@nbma.info:mansur/test-oxidized.git</span></span><br><span class="line">    <span class="attr">publickey:</span> <span class="string">/root/.ssh/id_rsa.pub</span></span><br><span class="line">    <span class="attr">privatekey:</span> <span class="string">/root/.ssh/id_rsa</span></span><br></pre></td></tr></table></figure>

<h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p>准备好配置文件之后，就可以运行了，默认直接在bash里已经安装了<code>oxidized</code>命令；<br>使用<code>oxidized &amp;</code>来后台运行<br>或者启动一个screen，或者启动oxidied.service<br>查看日志，备份的file，或者git来确认备份进度</p>
<h2 id="其他feature"><a href="#其他feature" class="headerlink" title="其他feature"></a>其他feature</h2><h3 id="nginx的web验证"><a href="#nginx的web验证" class="headerlink" title="nginx的web验证"></a>nginx的web验证</h3><p>nginx安装之前有<a href="https://nbma.info/learn-nginx/">写过</a><br>账号密码的话，需要使用apache的httpd-tools来生成密码文件，或者不想安装的话，可以使用<a target="_blank" rel="noopener" href="http://tool.oschina.net/htpasswd">在线 htpasswd 生成器</a></p>
<p>手动生成的话使用以下命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">htpasswd –c /home/htpasswd user1</span><br><span class="line"><span class="comment"># 回车之后，连续输入两次密码即可。后续添加用户不需要-c参数</span></span><br><span class="line">htpasswd /home/htpasswd user2</span><br></pre></td></tr></table></figure>

<p>然后，新建nginx配置文件：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name 192.168.1.1;</span><br><span class="line"></span><br><span class="line">        auth_basic &quot;oxidized web UI login&quot;;</span><br><span class="line">        auth_basic_user_file /home/htpasswd;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                proxy_pass http://127.0.0.1:8888/;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        access_log /var/log/nginx/access_oxidized.log;</span><br><span class="line">        error_log /var/log/nginx/error_oxidized.log;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>重启nginx就可以了</p>
<h3 id="设备group"><a href="#设备group" class="headerlink" title="设备group"></a>设备group</h3><p>当网络设备足够多时，可以将设备分组，以实现对某些属性的批量管理。</p>

      </div>
      <div class="post-copyright">
    <p class="copyright-item">
      <span>原文作者: </span>
      <a href="http://nbma.info">Mansur</a>
    </p>
    <p class="copyright-item">
      <span>原文链接: </span>
      <a href="http://nbma.info/maybe-the-best-conf-backup-tool-oxidized/">http://nbma.info/maybe-the-best-conf-backup-tool-oxidized/</a>
    </p>
    <p class="copyright-item">
      <span>许可协议: </span>除特别声明外，本站文章均采用<a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh" target="_blank">CC BY-NC 4.0</a>许可协议，转载请注明出处。
    </p>
  </div>
      <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden />
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code"><label class="qr-code-image" for="reward">
          <img class="image" src="/img/68e0aeafly1frp3nwyrulj20jq0jqwh1.jpg" title="wechat">
        </label>
      <label class="qr-code-image" for="reward">
          <img class="image" src="/img/68e0aeafly1frp3nsphm6j20jq0jqacp.jpg" title="alipay">
        </label>
      </div>
  </div><footer class="post-footer">
        <div class="post-tags">
            <a href="/tags/network/">network</a>
            <a href="/tags/centos/">centos</a>
            <a href="/tags/oxidized/">oxidized</a>
            </div>
        
        <nav class="post-nav"><a class="prev" href="/docker-basic/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">docker学习笔记</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    <a class="next" href="/snmp-url/">
        <span class="next-text nav-default">一些不太好找的mib/oid</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"><div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:i@nbma.info" class="iconfont icon-email" title="email"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" target="_blank" rel="noopener" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2013 - 2023<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Mansur</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://nbma.info/maybe-the-best-conf-backup-tool-oxidized/';
        this.page.identifier = 'maybe-the-best-conf-backup-tool-oxidized/';
        this.page.title = '可能是目前最好用的网络配置备份工具-oxidized';
    };
    (function() {
    var d = document, s = d.createElement('script');

    s.src = '//nbma.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();  
  </script><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.1"></script>
<!-- hexo injector body_end start --><script src="/js/post_date.js"></script><!-- hexo injector body_end end --></body>
</html>
